<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åƒåœ¾åˆ†ç±» Demo</title>
    <style>
      /* --- 1. å…¨å±€ä¸å®¹å™¨è®¾ç½® --- */
      body {
        margin: 0;
        padding: 0;
        background-color: #333;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: "Microsoft YaHei", sans-serif;
      }

      #game-container {
        width: 1280px;
        height: 720px;
        position: relative;
        background-color: #87ceeb;
        background-image: url("assets/fenlei/bj.jpeg");
        background-size: cover;
        background-position: center;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        overflow: hidden;
      }

      /* --- 2. ç›®æ ‡åŒºåŸŸ (åƒåœ¾æ¡¶å®¹å™¨) --- */
      .bins-area {
        position: absolute;
        top: 10%;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 50px; /* ä¸¤ä¸ªæ¡¶ä¹‹é—´çš„é—´è· */
        z-index: 10;
      }

      .target-bin {
        width: 250px;
        height: 300px;
        background-repeat: no-repeat;
        background-size: contain;
        background-position: center;
        transition: transform 0.2s;
      }

      /* å¯å›æ”¶æ¡¶ */
      #bin-recyclable {
        background-image: url("assets/fenlei/kehuishou.png");
      }

      /* å¨ä½™æ¡¶ (ä½¿ç”¨ chuyu.png ä½œä¸ºæ¡¶çš„ç´ æï¼Œæ ¹æ®éœ€æ±‚) */
      #bin-kitchen {
        background-image: url("assets/fenlei/chuyu.png");
      }

      .target-bin.drag-over {
        transform: scale(1.1);
        filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.8));
      }

      /* --- 3. åƒåœ¾é¡¹åŒºåŸŸ --- */
      /* åˆ†å¸ƒåœ¨åº•éƒ¨ */
      .items-area {
        position: absolute;
        bottom: 50px;
        left: 0;
        width: 100%;
        height: 250px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 40px;
        z-index: 20;
      }

      .garbage-item {
        width: 140px;
        height: 140px;
        cursor: grab;
        transition: transform 0.2s, opacity 0.3s;
        filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
        position: relative;
      }

      .garbage-item img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        pointer-events: none; /* å›¾ç‰‡æœ¬èº«ä¸å“åº”äº‹ä»¶ï¼Œç”±çˆ¶å®¹å™¨å“åº” */
      }

      .garbage-item:active {
        cursor: grabbing;
        transform: scale(1.1);
      }

      /* --- 4. æŒ‰é’®ä¸åé¦ˆ --- */
      .reset-btn {
        position: absolute;
        bottom: 30px;
        right: 40px;
        width: 100px;
        height: 40px;
        background-image: url("assets/reset.png");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        background-color: transparent;
        border: none;
        cursor: pointer;
        opacity: 0.8;
        transition: opacity 0.2s;
        z-index: 50;
      }
      .reset-btn:hover {
        opacity: 1;
      }

      #feedback {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.85);
        color: white;
        padding: 30px 60px;
        border-radius: 15px;
        font-size: 28px;
        display: none;
        z-index: 100;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div id="game-container">
      <!-- ç›®æ ‡æ¡¶åŒºåŸŸ -->
      <div class="bins-area">
        <!-- å¯å›æ”¶æ¡¶ -->
        <div
          class="target-bin"
          id="bin-recyclable"
          ondragover="handleDragOver(event, this)"
          ondrop="handleDrop(event, 'recyclable', this)"
          ondragleave="handleDragLeave(event, this)"
        ></div>

        <!-- å¨ä½™/å…¶ä»–æ¡¶ -->
        <div
          class="target-bin"
          id="bin-kitchen"
          ondragover="handleDragOver(event, this)"
          ondrop="handleDrop(event, 'kitchen', this)"
          ondragleave="handleDragLeave(event, this)"
        ></div>
      </div>

      <!-- åƒåœ¾ç‰©å“ -->
      <div class="items-area" id="items-container">
        <!-- æ˜“æ‹‰ç½ï¼šå¯å›æ”¶ -->
        <div
          class="garbage-item"
          draggable="true"
          ondragstart="handleDragStart(event, 'recyclable', this)"
          id="item-yilaguan"
        >
          <img src="assets/fenlei/yilaguan.png" alt="æ˜“æ‹‰ç½" />
        </div>

        <!-- Tæ¤ï¼šå¯å›æ”¶ -->
        <div
          class="garbage-item"
          draggable="true"
          ondragstart="handleDragStart(event, 'recyclable', this)"
          id="item-tshirt"
        >
          <img src="assets/fenlei/tshirt.png" alt="Tæ¤" />
        </div>

        <!-- ç”µæ± ï¼šæœ‰å®³åƒåœ¾ (other) - æš‚æ—¶æ— å¤„å¯å»ï¼Œæˆ–è€…è®¾å®šä¸æ¥å— -->
        <div
          class="garbage-item"
          draggable="true"
          ondragstart="handleDragStart(event, 'other', this)"
          id="item-dianchi"
        >
          <img src="assets/fenlei/dianchi.png" alt="ç”µæ± " />
        </div>

        <!-- éª¨å¤´ï¼šå¨ä½™åƒåœ¾ (kitchen) -->
        <div
          class="garbage-item"
          draggable="true"
          ondragstart="handleDragStart(event, 'kitchen', this)"
          id="item-gutou"
        >
          <img src="assets/fenlei/gutou.png" alt="éª¨å¤´" />
        </div>
      </div>

      <button
        class="reset-btn"
        onclick="resetGame()"
        aria-label="é‡ç½®"
      ></button>
      <div id="feedback"></div>
    </div>

    <script>
      let draggedItem = null; // å½“å‰æ‹–æ‹½çš„å…ƒç´  DOM
      let draggedType = null; // å½“å‰æ‹–æ‹½çš„ç±»å‹

      function handleDragStart(e, type, el) {
        draggedType = type;
        draggedItem = el;
        e.dataTransfer.effectAllowed = "move";
      }

      function handleDragOver(e, binEl) {
        e.preventDefault();
        e.dataTransfer.dropEffect = "move";
        binEl.classList.add("drag-over");
      }

      function handleDragLeave(e, binEl) {
        binEl.classList.remove("drag-over");
      }

      function handleDrop(e, targetType, binEl) {
        e.preventDefault();
        binEl.classList.remove("drag-over");

        if (!draggedItem) return;

        // åˆ¤å®šé€»è¾‘: æ‹–æ‹½ç±»å‹ä¸ç›®æ ‡ç±»å‹ä¸€è‡´
        if (draggedType === targetType) {
          // æ­£ç¡®
          draggedItem.style.visibility = "hidden";
          draggedItem.style.display = "none";
          showFeedback("âœ… åˆ†ç±»æ­£ç¡®ï¼");
          checkWin();
        } else {
          // é”™è¯¯
          let msg = "âŒ åˆ†ç±»é”™è¯¯ï¼";
          if (targetType === "recyclable") msg = "âŒ è¿™é‡Œæ˜¯å¯å›æ”¶åƒåœ¾æ¡¶ï¼";
          if (targetType === "kitchen") msg = "âŒ è¿™é‡Œæ˜¯å¨ä½™åƒåœ¾æ¡¶ï¼"; // å‡è®¾chuyuæ˜¯å¨ä½™

          showFeedback(msg);

          // ç®€å•çš„æ™ƒåŠ¨åŠ¨ç”»åé¦ˆ
          draggedItem.animate(
            [
              { transform: "translateX(0)" },
              { transform: "translateX(-10px)" },
              { transform: "translateX(10px)" },
              { transform: "translateX(0)" },
            ],
            { duration: 300 }
          );
        }

        draggedItem = null;
        draggedType = null;
      }

      function checkWin() {
        // æ£€æŸ¥æ‰€æœ‰å¾…åˆ†ç±»é¡¹ (yilaguan, tshirt, chuyu, gutou)
        // ç”µæ± æ²¡æœ‰å¯¹åº”æ¡¶ï¼Œæ‰€ä»¥ä¸è®¡å…¥èƒœåˆ©æ¡ä»¶ï¼Œæˆ–è€…å¦‚æœç”¨æˆ·è§†ä¸ºå¹²æ‰°é¡¹åˆ™å¿½ç•¥
        const targetIds = [
          "item-yilaguan",
          "item-tshirt",
          "item-chuyu",
          "item-gutou",
        ];
        const remaining = targetIds.filter((id) => {
          const el = document.getElementById(id);
          return el && el.style.display !== "none";
        });

        if (remaining.length === 0) {
          setTimeout(() => {
            showFeedback("ğŸ‰ åƒåœ¾åˆ†ç±»å®Œæˆï¼");
          }, 500);
        }
      }

      function showFeedback(text) {
        const el = document.getElementById("feedback");
        el.innerText = text;
        el.style.display = "block";

        // æ¸…é™¤ä¸Šä¸€æ¬¡çš„ timer (ç®€ç•¥å¤„ç†)
        setTimeout(() => {
          el.style.display = "none";
        }, 1500);
      }

      function resetGame() {
        const items = document.querySelectorAll(".garbage-item");
        items.forEach((item) => {
          item.style.display = "block";
          item.style.visibility = "visible";
        });
        document.getElementById("feedback").style.display = "none";
      }
    </script>
  </body>
</html>
