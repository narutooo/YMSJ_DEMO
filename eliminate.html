<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ¶ˆé™¤é¢˜ Demo</title>
    <style>
      /* --- 1. å…¨å±€ä¸å®¹å™¨è®¾ç½® --- */
      body {
        margin: 0;
        padding: 0;
        background-color: #333;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: "Microsoft YaHei", sans-serif;
      }

      #game-container {
        width: 1280px;
        height: 720px;
        position: relative;
        background-color: #87ceeb;
        background-image: url("assets/eliminate/bj.png");
        background-size: cover;
        background-position: center;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        overflow: hidden;
      }

      /* --- 2. æ ‡é¢˜æ¡†æ ·å¼ (ä¿æŒä¸€è‡´æ€§) --- */

      /* --- 3. äººç‰©å›¾ç‰‡æ ·å¼ --- */
      .character {
        position: absolute;
        width: 150px; /* å‡è®¾å›¾ç‰‡å®½åº¦ï¼Œå¯è°ƒæ•´ */
        height: auto;
        cursor: pointer;
        transition: top 1s ease-in-out, left 1s ease-in-out; /* å¹³æ»‘ç§»åŠ¨æ•ˆæœ */
        user-select: none;
        z-index: 20;
      }

      .character:hover {
        filter: brightness(1.2);
        transform: scale(1.05);
      }

      .character:active {
        transform: scale(0.95);
      }

      /* --- 4. åé¦ˆå¼¹çª— --- */
      #feedback {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.85);
        color: white;
        padding: 30px 60px;
        border-radius: 15px;
        font-size: 28px;
        display: none;
        z-index: 100;
        text-align: center;
      }

      /* --- 5. é‡ç½®æŒ‰é’® --- */
      .reset-btn {
        position: absolute;
        bottom: 24px;
        right: 50px;
        width: 120px;
        height: 50px;
        background-color: transparent;
        background-image: url("assets/reset.png");
        background-repeat: no-repeat;
        background-size: contain;
        background-position: center;
        border: none;
        cursor: pointer;
        z-index: 20;
        transition: transform 0.1s;
      }

      .reset-btn:active {
        transform: translateY(2px);
      }
    </style>
  </head>
  <body>
    <div id="game-container">
      <!-- äººç‰©å®¹å™¨ -->
      <div id="characters-container">
        <!-- åŠ¨æ€ç”Ÿæˆæˆ–é™æ€å†™æ­» -->
        <img
          src="assets/eliminate/a.png"
          class="character"
          id="char-a"
          alt="Character A"
          draggable="false"
        />
        <img
          src="assets/eliminate/b.png"
          class="character"
          id="char-b"
          alt="Character B"
          draggable="false"
        />
        <img
          src="assets/eliminate/c.png"
          class="character"
          id="char-c"
          alt="Character C"
          draggable="false"
        />
      </div>

      <button
        class="reset-btn"
        onclick="resetGame()"
        aria-label="é‡ç½®"
      ></button>

      <div id="feedback"></div>
    </div>

    <script>
      // é…ç½®
      const MOVE_INTERVAL = 5000; // 5ç§’
      const CONTAINER_WIDTH = 1280;
      const CONTAINER_HEIGHT = 720;
      const TOP_LIMIT_PERCENT = 0.25; // 25%

      const characters = document.querySelectorAll(".character");
      let moveTimer = null;

      function init() {
        // åˆå§‹ä½ç½®éšæœº
        characters.forEach((char) => moveCharacter(char));

        // ç‚¹å‡»äº‹ä»¶
        characters.forEach((char) => {
          char.onclick = () => eliminate(char);
        });

        // å®šæ—¶ç§»åŠ¨
        startMoving();
      }

      function startMoving() {
        // ç«‹å³æ‰§è¡Œä¸€æ¬¡ç§»åŠ¨å—ï¼Ÿéœ€æ±‚æ˜¯"æ¯5ç§’ç§»åŠ¨ä¸€æ¬¡"ï¼Œåˆå§‹ä½ç½®å·²ç»åœ¨inité‡Œéšæœºäº†
        moveTimer = setInterval(() => {
          characters.forEach((char) => {
            if (char.style.display !== "none") {
              moveCharacter(char);
            }
          });
        }, MOVE_INTERVAL);
      }

      function moveCharacter(element) {
        // è·å–å…ƒç´ å°ºå¯¸ (å¦‚æœå›¾ç‰‡æœªåŠ è½½å®Œæˆå¯èƒ½ä¸å‡†ï¼Œç»™ä¸ªé»˜è®¤å€¼æˆ–ç›‘å¬load)
        // è¿™é‡Œå‡è®¾å›¾ç‰‡å®½åº¦ä¸è¶…è¿‡200ï¼Œé«˜åº¦ä¸è¶…è¿‡300ï¼Œå®‰å…¨èµ·è§å¯ä»¥åŠ¨æ€è·å–
        const w = element.offsetWidth || 150;
        const h = element.offsetHeight || 150;

        const containerW = CONTAINER_WIDTH;
        const containerH = CONTAINER_HEIGHT;

        // è®¡ç®—å¯ç”¨åŒºåŸŸ
        // Top å¿…é¡» >= 25% * 720 = 180
        const minTop = containerH * TOP_LIMIT_PERCENT;
        const maxTop = containerH - h;
        const maxLeft = containerW - w;

        // éšæœºåæ ‡
        const randomX = Math.random() * maxLeft;
        const randomY = minTop + Math.random() * (maxTop - minTop);

        element.style.left = randomX + "px";
        element.style.top = randomY + "px";
      }

      function eliminate(element) {
        element.style.display = "none";

        // æ£€æŸ¥æ˜¯å¦å…¨éƒ¨æ¶ˆé™¤
        checkWin();
      }

      function checkWin() {
        const remaining = Array.from(characters).filter(
          (c) => c.style.display !== "none"
        );
        if (remaining.length === 0) {
          showFeedback("ğŸ‰ å…¨éƒ¨æ¶ˆé™¤ï¼");
          clearInterval(moveTimer);
        }
      }

      function showFeedback(text) {
        const el = document.getElementById("feedback");
        el.innerText = text;
        el.style.display = "block";
        setTimeout(() => {
          el.style.display = "none";
        }, 2000);
      }

      function resetGame() {
        // é‡ç½®æ‰€æœ‰å›¾ç‰‡æ˜¾ç¤º
        characters.forEach((char) => {
          char.style.display = "block";
          moveCharacter(char);
        });

        // é‡æ–°å¼€å§‹è®¡æ—¶å™¨
        clearInterval(moveTimer);
        startMoving();

        document.getElementById("feedback").style.display = "none";
      }

      // ç¡®ä¿å›¾ç‰‡åŠ è½½åèƒ½æ­£ç¡®è®¡ç®—å®½é«˜ï¼Œä¸è¿‡ CSS æ—¢ç„¶æ²¡å®šæ­»å®½é«˜ï¼Œæœ€å¥½onload
      // ç®€å•èµ·è§ï¼Œå»¶æ—¶ä¸€å°ä¼šå„¿æˆ–è€…ç›´æ¥ç”± CSS æ§åˆ¶å¤§æ¦‚å¤§å°
      window.onload = init;
    </script>
  </body>
</html>
